# Cerbo GX
ENV{BASE_COMPATIBLE}!="victronenergy,cerbo-gx|victronenergy,cerbo-gx-s", GOTO="end-cerbo-gx"

ACTION=="add", KERNEL=="ttyS4", ENV{VE_PRODUCT}="builtin-mkx", ENV{VE_SERVICE}="mkx"
ACTION=="add", KERNEL=="ttyS[5-7]", ENV{VE_PRODUCT}="builtin-vedirect", ENV{VE_SERVICE}="vedirect"
ACTION=="add", SUBSYSTEM=="iio", ATTR{name}=="cerbo-gx-adc", SYMLINK+="adc/builtin0"
ACTION=="change", SUBSYSTEM=="drm", ENV{HOTPLUG}=="1", RUN+="display-hotplug %p HDMI-A-1 i2c-2"
ACTION=="change", KERNEL=="*.rtc", ENV{LOSC}=="1", RUN+="sunxi-losc-status %s{losc_status}"

# The second CAN is not available on the Cerbo-S GX, and hence will not be discovered.
# NOTE: a new / patched linux is needed to be able to set the bitrate later with ip.
ACTION=="add", KERNEL=="ttyS3", ENV{VE_SERVICE}="ignore", RUN+="/usr/bin/slcand -o -f -t hw -S 1500000 /dev/ttyS3 can1"

LABEL="end-cerbo-gx"
